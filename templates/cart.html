{% extends "base.html" %}
{% block title %}–ö–æ—Ä–∑–∏–Ω–∞ ‚Äî –®–∏–ø–æ–≤–Ω–∏–∫{% endblock %}

{% block content %}
<section class="catalog" style="padding: 60px 0;">
    <div class="container">
        <h1 style="font-size: 3.5rem; text-align: center; margin-bottom: 60px; color: #ff2e63; font-weight: 800;">
            –ö–æ—Ä–∑–∏–Ω–∞
        </h1>

        {% if cart_items|length > 0 %}
            <!-- –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –∫–æ—Ä–∑–∏–Ω–∞ -->
            <div class="products-grid">
                {% for item in cart_items %}
                <article class="product-card" style="position: relative; padding: 30px;">
                    <div class="product-card__image">
                        <img src="{{ url_for('static', filename='images/products/' + item.product.image) }}"
                             alt="{{ item.product.title }}"
                             onerror='this.src="{{ url_for('static', filename="images/placeholder.png") }}"'>
                    </div>

                    <div class="product-card__info">
                        <h3 class="product-card__title">{{ item.product.title }}</h3>
                        {% if item.size %}
                            <div class="product-card__size">–†–∞–∑–º–µ—Ä: {{ item.size }}</div>
                        {% endif %}
                        {% if item.product.sizes %}
                            <div class="product-card__available-sizes">–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã: {{ item.product.sizes }}</div>
                        {% endif %}
                        <span style="font-size: 1.6rem; color: #ff2e63; font-weight: 700;">{{ item.product.price }} ‚ÇΩ</span>

                        <!-- –ö–æ–ª-–≤–æ -->
                        <div class="quantity-wrapper" style="margin: 20px 0; text-align: center;">
                            <!-- –§–æ—Ä–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å CSRF –∏ —É–¥–∞–ª–µ–Ω–∏–µ–º –ø—Ä–∏ 0 -->
                             <form action="{{ url_for('update_cart_item', cart_item_id=item.id) }}" method="POST" class="quantity-form">
                               <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                               <button type="button" class="quantity-btn minus">-</button>
                               <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="quantity-input">
                              <button type="button" class="quantity-btn plus">+</button>
                            </form>
                            <p style="margin-top: 10px; font-weight: 700;">–ò—Ç–æ–≥–æ: {{ (item.quantity * item.product.price)|int }} ‚ÇΩ</p>
                        </div>

                        <!-- –£–¥–∞–ª–µ–Ω–∏–µ -->
                        <form action="{{ url_for('remove_from_cart', cart_item_id=item.id) }}" method="POST" style="position: absolute; top: 20px; right: 20px;">
                             <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                             <button type="submit" style="background:none; border:none; font-size:1.8rem; color:#ff2e63; cursor:pointer;">‚úï</button>
                        </form>
                    </div>
                </article>
                {% endfor %}
            </div>

            <!-- –æ–±—â–∞—è —Å—É–º–º–∞ –∏ –∫–Ω–æ–ø–∫–∏ -->
            <div style="text-align:center; margin:60px 0;">
                <p style="font-size:2.2rem;">–û–±—â–∞—è —Å—É–º–º–∞: <strong style="color:#ff2e63; font-size:3rem;">{{ total|int }} ‚ÇΩ</strong></p>
                <div style="margin-top:30px; display:flex; gap:20px; justify-content:center; flex-wrap:wrap;">
                    <a href="{{ url_for('catalog') }}" style="padding:16px 40px; border:2px solid #ff2e63; color:#ff2e63; border-radius:50px; text-decoration:none; font-size:1.2rem;">
                        ‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏
                    </a>
                    <a href="#" style="padding:16px 40px; background:#ff2e63; color:white; border-radius:50px; text-decoration:none; font-size:1.3rem;">
                        –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                    </a>
                </div>
            </div>

        {% else %}
            <!-- –ü—É—Å—Ç–∞—è –∫–æ—Ä–∑–∏–Ω–∞ -->
            <div style="text-align:center; padding:100px 20px;">
                <div style="font-size:8rem; margin-bottom:30px;">üõí</div>
                <h2 style="font-size:3rem; color:#ff2e63; margin-bottom:20px;">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h2>
                <p style="font-size:1.6rem; color:#777; max-width:700px; margin:0 auto 40px;">
                    –ü–æ—Ö–æ–∂–µ, –≤—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É. –°–∞–º–æ–µ –≤—Ä–µ–º—è —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å!
                </p>
                <a href="{{ url_for('catalog') }}" style="background:#ff2e63; color:white; padding:18px 50px; border-radius:50px; text-decoration:none; font-size:1.4rem;">
                    –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥
                </a>
            </div>
        {% endif %}
    </div>
</section>

<!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –∫–Ω–æ–ø–æ–∫ +/‚àí -->
<script src="{{ url_for('static', filename='js/cart.js') }}"></script>
{% endblock %}