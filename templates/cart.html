{% extends "base.html" %}
{% block title %}–ö–æ—Ä–∑–∏–Ω–∞ ‚Äî –®–∏–ø–æ–≤–Ω–∏–∫{% endblock %}

{% block content %}
<section class="cart-section">
    <div class="container">
        <h1 class="cart-title">–ö–æ—Ä–∑–∏–Ω–∞</h1>

        {% if cart_items %}
            <!-- –ï—Å–ª–∏ –∫–æ—Ä–∑–∏–Ω–∞ –Ω–µ –ø—É—Å—Ç–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–≤–∞—Ä—ã -->
            <div class="cart-items">
                {% for item in cart_items %}
                <div class="cart-item" data-item-id="{{ item.id }}">
                    <div class="cart-item-image">
                        <img src="{{ url_for('static', filename='images/products/' + item.product.image) }}" alt="{{ item.product.title }}">
                    </div>
                    <div class="cart-item-details">
                        <h3 class="cart-item-title">{{ item.product.title }}</h3>
                        <p class="cart-item-brand">{{ item.product.brand or '–ù–µ—Ç –±—Ä–µ–Ω–¥–∞' }}</p>
                        <p class="cart-item-color">{{ item.product.color or '–ù–µ—Ç —Ü–≤–µ—Ç–∞' }}</p>
                        <p class="cart-item-sizes">–†–∞–∑–º–µ—Ä—ã: {{ item.product.sizes or '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π' }}</p>
                    </div>
                    <div class="cart-item-price">
                        <p class="cart-item-price-current">‚ÇΩ{{ "%.2f"|format(item.product.price) }}</p>
                        {% if item.product.old_price and item.product.old_price > item.product.price %}
                            <p class="cart-item-price-old">‚ÇΩ{{ "%.2f"|format(item.product.old_price) }}</p>
                        {% endif %}
                    </div>
                    <div class="cart-item-quantity">
                        <form method="POST" action="{{ url_for('update_cart_item', cart_item_id=item.id) }}" class="quantity-form">
                            <button type="button" class="quantity-btn minus">-</button>
                            <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="quantity-input">
                            <button type="button" class="quantity-btn plus">+</button>
                            <button type="submit" class="quantity-update-btn">–û–±–Ω–æ–≤–∏—Ç—å</button>
                        </form>
                    </div>
                    <div class="cart-item-subtotal">
                        <p class="cart-item-subtotal-price">‚ÇΩ{{ "%.2f"|format(item.product.price * item.quantity) }}</p>
                    </div>
                    <div class="cart-item-actions">
                        <form method="POST" action="{{ url_for('remove_from_cart', cart_item_id=item.id) }}" class="remove-form">
                            <button type="submit" class="btn btn--small btn--danger">–£–¥–∞–ª–∏—Ç—å</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>

            <!-- –ò—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ -->
            <div class="cart-summary">
                <div class="cart-summary-item">
                    <span>–ò—Ç–æ–≥–æ:</span>
                    <span class="cart-summary-price">‚ÇΩ{{ "%.2f"|format(total) }}</span>
                </div>
                <div class="cart-summary-actions">
                    <a href="{{ url_for('catalog') }}" class="btn btn--back">‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
                    <a href="#" class="btn btn--primary">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</a>
                </div>
            </div>
        {% else %}
            <!-- –ï—Å–ª–∏ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ -->
            <div class="cart-empty">
                <div class="cart-empty-icon">üõí</div>
                <h2 class="cart-empty-title">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h2>
                <p class="cart-empty-text">–ü–æ—Ö–æ–∂–µ, –≤—ã –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É. –°–∞–º–æ–µ –≤—Ä–µ–º—è —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å!</p>

                <div class="cart-suggestions">
                    <h3 class="cart-suggestions-title">–ß—Ç–æ –º–æ–∂–µ—Ç –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è:</h3>
                    <div class="cart-suggestions-grid">
                        <div class="suggestion-card">
                            <img src="{{ url_for('static', filename='images/placeholder.png') }}" alt="–ù–æ–≤–∏–Ω–∫–∏" class="suggestion-image">
                            <h4 class="suggestion-title">–ù–æ–≤–∏–Ω–∫–∏</h4>
                            <p class="suggestion-text">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è —Å–µ–∑–æ–Ω–∞</p>
                            <a href="{{ url_for('catalog') }}?new=true" class="btn btn--small suggestion-btn">–°–º–æ—Ç—Ä–µ—Ç—å</a>
                        </div>
                        <div class="suggestion-card">
                            <img src="{{ url_for('static', filename='images/placeholder.png') }}" alt="–†–∞—Å–ø—Ä–æ–¥–∞–∂–∞" class="suggestion-image">
                            <h4 class="suggestion-title">–†–∞—Å–ø—Ä–æ–¥–∞–∂–∞</h4>
                            <p class="suggestion-text">–°–∫–∏–¥–∫–∏ –¥–æ 70% –Ω–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏</p>
                            <a href="{{ url_for('catalog') }}?sale=true" class="btn btn--small suggestion-btn">–°–º–æ—Ç—Ä–µ—Ç—å</a>
                        </div>
                        <div class="suggestion-card">
                            <img src="{{ url_for('static', filename='images/placeholder.png') }}" alt="–ö–∞—Ç–∞–ª–æ–≥" class="suggestion-image">
                            <h4 class="suggestion-title">–í–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥</h4>
                            <p class="suggestion-text">–ë–æ–ª–µ–µ 500 –º–æ–¥–µ–ª–µ–π —Å –ª—é–±–æ–≤—å—é –¥–ª—è –≤–∞—Å</p>
                            <a href="{{ url_for('catalog') }}" class="btn btn--small suggestion-btn">–°–º–æ—Ç—Ä–µ—Ç—å</a>
                        </div>
                    </div>
                </div>

                <div class="cart-actions">
                    <a href="{{ url_for('index') }}" class="btn btn--back">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                    <a href="{{ url_for('catalog') }}" class="btn btn--primary">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
                </div>
            </div>
        {% endif %}

        <div class="cart-benefits">
            <div class="benefit-item">
                <div class="benefit-icon">üöö</div>
                <div class="benefit-text">
                    <h4>–ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</h4>
                    <p>–î–æ—Å—Ç–∞–≤–∏–º –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏ –∑–∞ 2-5 –¥–Ω–µ–π</p>
                </div>
            </div>
            <div class="benefit-item">
                <div class="benefit-icon">üîÑ</div>
                <div class="benefit-text">
                    <h4>–õ–µ–≥–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç</h4>
                    <p>–í–µ—Ä–Ω–µ–º –¥–µ–Ω—å–≥–∏ –∏–ª–∏ –æ–±–º–µ–Ω—è–µ–º —Ç–æ–≤–∞—Ä –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π</p>
                </div>
            </div>
            <div class="benefit-item">
                <div class="benefit-icon">üí≥</div>
                <div class="benefit-text">
                    <h4>–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–ø–ª–∞—Ç–∞</h4>
                    <p>–í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∑–∞—â–∏—â–µ–Ω—ã –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã</p>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    // –°–∫—Ä–∏–ø—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ
    document.addEventListener('DOMContentLoaded', function() {
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ +/-
        document.querySelectorAll('.quantity-btn').forEach(button => {
            button.addEventListener('click', function() {
                const form = this.closest('.quantity-form');
                const input = form.querySelector('.quantity-input');
                let value = parseInt(input.value);

                if (this.classList.contains('minus')) {
                    value = Math.max(1, value - 1);
                } else if (this.classList.contains('plus')) {
                    value += 1;
                }

                input.value = value;
            });
        });

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
        document.querySelectorAll('.quantity-input').forEach(input => {
            input.addEventListener('change', function() {
                const form = this.closest('.quantity-form');
                form.submit();
            });
        });
    });
</script>
{% endblock %}
